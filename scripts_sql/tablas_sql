-- Tabla cuentas
CREATE TABLE cuentas (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    username VARCHAR2(50) NOT NULL,
    password_hash VARCHAR2(255) NOT NULL,
    rol VARCHAR2(20) NOT NULL,
    nombre VARCHAR2(50),
    apellido VARCHAR2(50),
    email VARCHAR2(100)
);

-- Tabla paciente
CREATE TABLE paciente (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    username VARCHAR2(50) NOT NULL,
    nombre VARCHAR2(50),
    apellido VARCHAR2(50),
    email VARCHAR2(100),
    comuna VARCHAR2(50),
    fecha_primera_visita DATE
);

-- Tabla doctor
CREATE TABLE doctor (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    username VARCHAR2(50) NOT NULL,
    nombre VARCHAR2(50),
    apellido VARCHAR2(50),
    email VARCHAR2(100),
    especialidad VARCHAR2(50),
    horario_atencion VARCHAR2(50),
    fecha_ingreso DATE
);

CREATE TABLE insumos (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nombre VARCHAR2(100) NOT NULL,
    tipo VARCHAR2(50),
    stock NUMBER
);

CREATE TABLE recetas (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    id_paciente NUMBER NOT NULL,
    id_medico NUMBER NOT NULL,
    descripcion VARCHAR2(500),
    FOREIGN KEY (id_paciente) REFERENCES paciente(id),
    FOREIGN KEY (id_medico) REFERENCES doctor(id)
);

CREATE TABLE consultas (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    id_paciente NUMBER NOT NULL,
    id_medico NUMBER NOT NULL,
    id_receta NUMBER,
    fecha DATE,
    comentarios VARCHAR2(500),
    FOREIGN KEY (id_paciente) REFERENCES paciente(id),
    FOREIGN KEY (id_medico) REFERENCES doctor(id),
    FOREIGN KEY (id_receta) REFERENCES recetas(id)
);

CREATE TABLE agenda (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    id_paciente NUMBER NOT NULL,
    id_medico NUMBER NOT NULL,
    fecha_consulta DATE NOT NULL,
    estado VARCHAR2(20),
    FOREIGN KEY (id_paciente) REFERENCES paciente(id),
    FOREIGN KEY (id_medico) REFERENCES doctor(id)
);
